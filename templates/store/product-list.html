{% extends 'base.html' %}
{% block content %}

<!-- Filter -->
<div class="filter-container">
    <!-- Category Filter -->
    {% for category in categories %}
    <div class="category-filter">
        <input type="checkbox" class="filter-checkbox" data-filter="category" value="{{ category.cid }}" id="categoryCheckbox"/>
        <a href="{% url 'store:category-product-list' category.cid %}">
            <img src="{{ category.image.url }}" height="32" width="32"/>{{ category.title }}
        </a>
    </div>
    {% endfor %}
    <!-- Price Filter -->
    <div id="slider-range" class="price-slider">
        <input type="range" name="range" id="range" value="{{ min_price.price__min|floatformat:2 }}" min="{{ min_price.price__min }}" max="{{ max_price.price__max }}" style="width: 100%;" oninput="max_price.value=this.value"/>
    </div>
    <!-- Min & Max Price-->
    <div class="price-display">
        <div>From: ${{ min_price.price__min|floatformat:2 }}</div>
        <div>To: ${{ max_price.price__max|floatformat:2 }}</div>
    </div>
    <div>
        <input type="number" id="max_price" value="{{ min_price.price__min|floatformat:2 }}" min="{{ min_price.price__min }}" max="{{ max_price.price__max }}" style="width: 100%;" onkeyup="range.value=this.value"/>
    </div>
    <div>
        <button id="price-filter-btn" type="button" style="width: 100%;">Filter</button>
    </div>
</div>

<div class="product-container">
    <div class="product-list" id="filtered-product">
        {% for product in products %}
        <!-- Product Item -->
        <div class="product-item">
            <!-- Product Discount -->
            <div class="product-discount">
                <span class="discount-badge">-{{ product.get_percentage|floatformat:0 }}%</span>
            </div>
            <!-- Product Image -->
            <div class="product-image">
                <img src="{{ product.image.url }}" alt="{{ product.title }}" height="128" width="128" />
            </div>
            <!-- Product Details -->
            <div class="product-details">
                <!-- Product Category -->
                <div class="product-category">
                    <a href="{% url 'store:category-product-list' product.category.cid %}">{{ product.category.title }}</a>
                </div>
                <!-- Product Title -->
                <div class="product-title">
                    <a href="{% url 'store:product-detail' product.pid %}">{{ product.title|truncatechars:50 }}</a>
                </div>
                <!-- Product Vendor -->
                <div class="product-vendor">
                    By <a href="{% url 'store:vendor-detail' product.vendor.vid %}">{{ product.vendor.title }}</a>
                </div>
                <!-- Product Price -->
                <div class="product-price">
                    <span>$</span><span id="current-price" class="current-price-{{ product.id }}">{{ product.price }}</span>
                    <span class="old-price">${{ product.old_price }}</span>
                </div>
            </div>
            <!-- Add To Cart -->
            <div>
                <input type="hidden" value="1" id="product-quantity" class="product-quantity-{{ product.id }}"/>
                <input type="hidden" value="{{ product.pid }}" class="product-pid-{{ product.id }}"/>
                <input type="hidden" value="{{ product.id }}" class="product-id-{{ product.id }}"/>
                <input type="hidden" value="{{ product.image.url }}" class="product-image-{{ product.id }}"/>
                <input type="hidden" value="{{ product.title }}" class="product-title-{{ product.id }}"/> 
                <button type="submit" class="add-to-cart-btn" data-index="{{ product.id }}" id="add-to-cart-btn"><i class="fas fa-shopping-cart"></i> Add</button>
                <button type="submit" class="add-to-wishlist" style="border: none; background: none;" data-product-item="{{ product.id }}"><i class="fa-regular fa-heart"></i></button>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

{% endblock content %}